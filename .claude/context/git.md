# Git Workflow Guide

Detailed guidance for git conventions defined in `git.yml`.

## Branch Naming

### Pattern Options

**Simple (no issue tracking):**
```
feature/add-user-auth
fix/login-redirect
chore/update-deps
```

**With issue numbers:**
```
issue/feature-123/add-user-auth
issue/fix-456/login-redirect
```

### Creating a Branch

```bash
# Always fetch first
git fetch origin main

# Create from remote main
git checkout -b feature/my-feature origin/main
```

## Commit Messages

### Format Options

**Conventional Commits:**
```
feat: add user authentication
fix: resolve login redirect loop
docs: update API documentation
refactor: extract validation logic
test: add auth service tests
chore: update dependencies
```

**Issue-Linked:**
```
#123 - add user authentication
#456 - fix login redirect loop
```

### HEREDOC Format (Recommended)

Use HEREDOC for multi-line commits to preserve formatting:

```bash
git commit -m "$(cat <<'EOF'
feat: add user authentication

- Implement JWT token generation
- Add password hashing with bcrypt
- Create auth middleware
- Add login/logout endpoints
EOF
)"
```

### Message Guidelines

1. **Imperative mood** - "add feature" not "added feature"
2. **Lowercase after prefix** - "feat: add" not "feat: Add"
3. **No period at end** - "add feature" not "add feature."
4. **Body explains what and why** - not how (code shows how)

## Pull Requests

### Title Format

Match your commit format:
- Conventional: `feat: add user authentication`
- Issue-linked: `#123 - add user authentication`

### Body Template

```markdown
## Summary
Brief description of what this PR does.

## Changes
- Change 1
- Change 2
- Change 3

## Testing
- How to test this change
- What was tested

## Notes
Any additional context or considerations.
```

### Pre-PR Checklist

- [ ] Tests pass locally
- [ ] Code follows project style
- [ ] Commits are clean (squash if needed)
- [ ] PR title matches commit format
- [ ] Base branch is correct (usually `main`)

## Common Operations

### Amending Last Commit

```bash
# Only if not pushed yet
git commit --amend -m "new message"

# Add files to last commit
git add forgotten-file.js
git commit --amend --no-edit
```

**Warning:** Never amend commits that have been pushed or that aren't yours.

### Interactive Rebase (Cleanup Before PR)

```bash
# Squash last 3 commits
git rebase -i HEAD~3
```

### Undoing Changes

```bash
# Undo staged changes
git restore --staged file.js

# Undo unstaged changes
git restore file.js

# Undo last commit (keep changes)
git reset --soft HEAD~1
```

## Attribution Policy

Depending on project policy:

**No attribution (default in some projects):**
```bash
# No Co-Authored-By tags
# No "Generated by AI" footers
```

**With attribution:**
```bash
git commit -m "$(cat <<'EOF'
feat: add feature

Co-Authored-By: Name <email>
EOF
)"
```

Check `git.yml` for your project's policy.
